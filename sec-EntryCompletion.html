<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8">
<title>16.4. Zone de saisie avec complètement (EntryCompletion)</title>
<link rel="stylesheet" href="pygtktutfr.css">
<meta name="generator" content="Bluefish 1.0.5">
<link rel="start" href="index.html" title="Tutoriel PyGTK 2.0">
<link rel="up" href="ch-NewInPyGTK2.4.html" title="Chapitre 16. Nouveaux Widgets dans PyGTK 2.4">
<link rel="prev" href="sec-ColorButtonAndFontButton.html" title="16.3. Bouton de couleur (ColorButton) et de police (FontButton)">
<link rel="next" href="sec-ExpanderWidget.html" title="16.5. Expanseur (Expander)">
<meta name="keywords" content="python,pygtk,tutoriel,traduction">
<link rel="home" href="index.html" title="Table des matières">
</head>
<body>
<div class="localisation">
 Vous êtes à peu près ici :
 <a href="../../index.html">Accueil</a>&nbsp; &raquo; &nbsp;
 <a href="../pygtktut.php">tutoriel PyGTK</a>&nbsp; &raquo; &nbsp;
 <a href="index.html">PyGTK : sommaire</a>
</div>
<!-- fin localisation -->
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">16.4. Zone de saisie avec complètement (EntryCompletion)</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="sec-ColorButtonAndFontButton.html">Préc.</a> </td>
<th width="60%" align="center">Chapitre 16. Nouveaux Widgets dans PyGTK 2.4</th>
<td width="20%" align="right"> <a accesskey="n" href="sec-ExpanderWidget.html">Suiv.</a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1" lang="fr">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="sec-EntryCompletion"></a>16.4. Zone de saisie avec complètement (EntryCompletion)</h2></div></div></div>
<p>Une zone de saisie avec complètement (<code class="classname">EntryCompletion</code>)
est un objet associé à un champ de saisie (<code class="classname">Entry</code>)
pour fournir la fonction de complètement.
Lorsque l'utilisateur entre des données dans le champ de saisie
<code class="classname">Entry</code>, le <code class="classname">EntryCompletion</code> fait
apparaître une fenêtre contextuelle montrant un ensemble de chaînes de caractères
correspondant au texte du champ de saisie(<code class="classname">Entry</code>)
</p>
<p>Un <code class="classname">EntryCompletion</code> est créé par le constructeur :
</p>
<pre class="programlisting">
  completion = gtk.EntryCompletion()
</pre>
<p>On peut utiliser la méthode <code class="methodname">set_completion</code>()
du champ de saisie <code class="classname">Entry</code> pour associer le
<code class="classname">EntryCompletion</code> au <code class="classname">Entry</code> :
</p>
<pre class="programlisting">
  entry.set_completion(<strong class="parameter"><code>completion</code></strong>)
</pre>
<p>Les chaînes de caractères qu'utilise le <code class="classname">EntryCompletion</code>
pour la correspondance sont récupérées depuis un <code class="classname">TreeModel</code>
(généralement un <code class="classname">ListStore</code>) qui doit être défini par la méthode :
</p>
<pre class="programlisting">
  completion.set_model(<strong class="parameter"><code>model</code></strong>)
</pre>
<p>Le <code class="classname">EntryCompletion</code> implémente l'interface
<code class="classname">CellLayout</code>, à la manière du
<code class="classname">TreeViewColumn</code>, pour gérer l'affichage des
données du <code class="classname">TreeModel</code>. La méthode suivante définit
un <code class="classname">EntryCompletion</code> sous la forme la plus
courante - une liste de chaînes de caractères :

</p>
<pre class="programlisting">
  completion.set_text_column(column)
</pre>
<p>Cette méthode est équivalente à  :</p>
<pre class="programlisting">
  cell = CellRendererText()
  completion.pack_start(cell)
  completion.add_attribute(cell, 'text', column)
</pre>
<p>Pour définir le nombre de caractères qui doivent être entrés avant que
le <code class="classname">EntryCompletion</code> recherche une correspondance,
on peut utiliser la méthode :
</p>
<pre class="programlisting">
  completion.set_minimum_key_length(<strong class="parameter"><code>length</code></strong>)
</pre>
<p>Le programme d'exemple <a href="exemples/entrycompletion.py" target="_top">
  <span><strong class="command">entrycompletion.py</strong></span></a> illustre
l'utilisation du <code class="classname">EntryCompletion</code>. La
<a href="sec-EntryCompletion.html#entrycompletionfig" title="Figure 16.10. Saisie avec complètement">Figure 16.10, « Saisie avec complètement »</a> montre le programme en cours
d'exécution.
</p>
<div class="figure">
<a name="entrycompletionfig"></a><p class="title"><b>Figure 16.10. Saisie avec complètement</b></p>
<div class="mediaobject" align="center"><img src="figures/entrycompletion.png" align="middle" alt="Exemple de zone de saisie avec complètement."></div>
</div>
<p>Le programme d'exemple démarre avec un faible nombre de chaînes de
complètement qui peut être augmenté en entrant des données dans le champ
de saisie et en appuyant sur la touche <span><strong class="keycap">Entrée</strong></span>. Si la chaîne est
unique, elle est ajoutée à la liste des chaînes de complètement.
</p>
<p>La fonction interne de concordance ne tient pas compte de la casse
(minuscule/majuscule). Si on a besoin d'une fonction plus spécifique, il est possible
d'utiliser la méthode suivante pour installer sa propre fonction de concordance :
</p>
<pre class="programlisting">
  completion.set_match_func(<em class="parameter"><code>func</code></em>, <em class="parameter"><code>user_data</code></em>)
</pre>
<p>La fonction <em class="parameter"><code>func</code></em> est :</p>
<pre class="programlisting">
  def func(completion, key_string, iter, data):
</pre>
<p>... où le paramètre <em class="parameter"><code>key_string</code></em> contient le contenu
courant du champ <code class="classname">Entry</code>, <em class="parameter"><code>iter</code></em> est
un <code class="classname">TreeIter</code> pointant sur une ligne dans le
<code class="classname">TreeModel</code> associé et <em class="parameter"><code>data</code></em> contient
les données utilisateur <em class="parameter"><code>user_data</code></em>. Le paramètre
 <em class="parameter"><code>func</code></em> devrait renvoyer <code class="literal">TRUE</code> si la
 chaîne de complètement de la ligne devrait être affichée.

</p>
<p>L'extrait de code suivant utilise une fonction de concordance pour afficher
les possibles chaînes de complètement qui commencent par le contenu du champ
de saisie et qui possèdent le suffixe indiqué (ici, un nom se terminant par
<code class="literal">.png</code> pour un fichier <code class="literal">PNG</code> file.
</p>
<pre class="programlisting">
  ...
  completion.set_match_func(end_match, (0, '.png'))
  ...
  def end_match(completion, entrystr, iter, data):
      column, suffix = data
      model = completion.get_model()
      modelstr = model[iter][column]
      return modelstr.startswith(entrystr) and modelstr.endswith(suffix)
  ...
</pre>
<p>Par exemple, si l'utilisateur tape 'mou' et que le modèle de complètement
contient une chaîne comme 'moulin.png', 'farine.png', 'moule.png' et 'mou.tif',
les choix 'moulin.png' et moule.png' seront proposés comme complètement.
</p>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="sec-ColorButtonAndFontButton.html">Préc.</a> </td>
<td width="20%" align="center"><a accesskey="u" href="ch-NewInPyGTK2.4.html">Chapitre parent</a></td>
<td width="40%" align="right"> <a accesskey="n" href="sec-ExpanderWidget.html">Suiv.</a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">16.3. Bouton de couleur (ColorButton) et de police (FontButton) </td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Table des matières</a></td>
<td width="40%" align="right" valign="top"> 16.5. Expanseur (Expander)</td>
</tr>
</table>
</div>
</body>
</html>
